<div class="navbar-left" [ngClass]="{ 'navbar-open': navbarOpen, 'navbar-close': !navbarOpen }">
	<!-- Logo -->
	<ul class="nav nav-logo">
		<!-- Logo -->
		<li class="element element-logo">
			<a href="/#/" [hidden]="navbarOpen">
				<img class="logo" src="/assets/images/nav-logo-icon.png" alt="Logo" />
			</a>
			<a href="/#/" [hidden]="!navbarOpen">
				<img class="logo" src="/assets/images/nav-logo.png" alt="Logo" />
			</a>
		</li>
	</ul>

	<div class="nav-inner-scroll">
		<!-- Main Nav -->
		<ul class="nav nav-main">
			<ng-container *ngFor="let navbarItem of navbarItems">
				<li class="element" *hasSomeRoles="navbarItem.hasSomeRoles">
					<a
						container="body"
						placement="left"
						routerLinkActive="active-link"
						tooltip="{{ navbarItem.title }}"
						[isDisabled]="navbarOpen"
						[routerLink]="navbarItem.path"
					>
						<span class="fa-solid fa-fw {{ navbarItem.iconClass }}"></span>
						<span [hidden]="!navbarOpen">{{ navbarItem.title }}</span>
					</a>
				</li>
			</ng-container>
		</ul>

		<!-- Bottom Aux Nav -->
		<ul class="nav nav-aux">
			<!-- Admin Nav	-->
			<li class="element nav-popover nav-popover-bottom" *hasRole="'admin'">
				<a
					[class.highlight-link]="adminNavOpen"
					container="body"
					containerClass="site-nav-popover-container"
					linkAccessibility
					placement="left"
					tooltip="Admin"
					#adminNavPopover="bs-popover"
					[isDisabled]="navbarOpen"
					[outsideClick]="true"
					[popover]="adminNav"
					(onHidden)="adminNavOpen = false"
					(onShown)="adminNavOpen = true"
				>
					<span class="fa-solid fa-fw fa-cog"></span>
					<span [hidden]="!navbarOpen">Admin</span>
				</a>

				<ng-template #adminNav>
					<ul class="popover-menu" role="menu">
						<li *ngFor="let adminItem of adminTopics">
							<a
								[routerLink]="[
									'admin/' + adminItem.path,
									{ clearCachedFilter: true }
								]"
								(click)="adminNavPopover.hide()"
							>
								{{ adminItem.title }}
							</a>
						</li>
					</ul>
				</ng-template>
			</li>

			<!-- Auditor Nav	-->
			<li class="element" *hasRole="'auditor'">
				<a
					container="body"
					placement="left"
					routerLink="/audit"
					routerLinkActive="active-link"
					tooltip="Audit Logs"
					[isDisabled]="navbarOpen"
				>
					<span class="fa-solid fa-fw fa-file-text"></span>
					<span [hidden]="!navbarOpen">Audit Logs</span>
				</a>
			</li>

			<!-- Team Nav   -->
			<li class="element" *hasRole="'user'">
				<a
					container="body"
					placement="left"
					routerLink="/team"
					routerLinkActive="active-link"
					tooltip="Teams"
					[isDisabled]="navbarOpen"
				>
					<span class="fa-solid fa-fw fa-users"></span>
					<span [hidden]="!navbarOpen">Teams</span>
				</a>
			</li>

			<!-- User Nav	-->
			<li class="element nav-popover nav-popover-bottom" *isAuthenticated>
				<a
					[class.highlight-link]="userNavOpen"
					container="body"
					containerClass="site-nav-popover-container"
					linkAccessibility
					placement="left"
					tooltip="User Profile"
					#userNavPopover="bs-popover"
					[isDisabled]="navbarOpen"
					[outsideClick]="true"
					[popover]="userNav"
					(onHidden)="userNavOpen = false"
					(onShown)="userNavOpen = true"
				>
					<span class="fa-solid fa-fw fa-user-circle" *ngIf="!isMasquerade"></span>
					<span class="fa-stack" *ngIf="isMasquerade">
						<span class="fa-solid fa-circle fa-stack-2x"></span>
						<span class="fa-solid fa-lg fa-user-secret fa-stack-1x text-primary"></span>
					</span>
					<span [hidden]="!navbarOpen">{{ session?.name }}</span>
				</a>

				<ng-template #userNav>
					<ul class="popover-menu" role="menu">
						<!-- User Signout -->
						<li><a href="/api/auth/signout">Sign out</a></li>
						<li *ngIf="session?.user?.eua">
							<a [routerLink]="['/eua']">View EUA</a>
						</li>

						<!-- User Preferences -->
						<li *ngIf="showUserPreferencesLink">
							<a [routerLink]="userPreferencesLink" (click)="userNavPopover.hide()">
								User Preferences
							</a>
						</li>

						<ng-container *ngIf="masqueradeEnabled">
							<li>
								<a
									routerLink="/masquerade"
									*ngIf="!isMasquerade && canMasquerade"
									(click)="userNavPopover.hide()"
								>
									Masquerade
								</a>
								<a routerLink="/masquerade" *ngIf="isMasquerade">
									Clear Masquerade
								</a>
							</li>
						</ng-container>
					</ul>
				</ng-template>
			</li>

			<li
				class="element"
				*ngIf="masqueradeEnabled && isMasquerade && (this.session?.name ?? null) === null"
			>
				<a
					container="body"
					placement="left"
					routerLink="masquerade"
					routerLinkActive="active-link"
					tooltip="Clear Masquerade"
					[isDisabled]="navbarOpen"
				>
					<span class="fa-stack">
						<span class="fa-solid fa-circle fa-stack-2x"></span>
						<span class="fa-solid fa-lg fa-user-secret fa-stack-1x text-primary"></span>
						<span class="fa-solid fa-ban fa-stack-2x text-danger"></span>
					</span>
					<span [hidden]="!navbarOpen">Clear Masquerade</span>
				</a>
			</li>

			<!-- Messages Nav   -->
			<li class="element nav-popover nav-popover-bottom" *hasRole="'user'">
				<a
					[class.highlight-link]="messagesNavOpen"
					container="body"
					containerClass="site-nav-popover-container-messages"
					linkAccessibility
					placement="left bottom"
					tooltip="Notifications"
					#messagesNavPopover="bs-popover"
					[isDisabled]="navbarOpen"
					[outsideClick]="true"
					[popover]="messagesNav"
					(onHidden)="messagesNavOpen = false"
					(onShown)="messagesNavOpen = true"
				>
					<span
						class="fa-solid fa-fw fa-bell"
						[class.messages-icon-new-messages-badge]="numNewMessages > 0"
						attr.newMessagesCount="{{ numNewMessages }}"
					></span>
					<span [hidden]="!navbarOpen">Notifications</span>
				</a>
				<ng-template #messagesNav>
					<app-recent-messages [container]="messagesNavPopover"></app-recent-messages>
				</ng-template>
			</li>

			<!-- Help Nav -->
			<li class="element nav-popover nav-popover-bottom">
				<a
					[class.highlight-link]="helpNavOpen"
					container="body"
					containerClass="site-nav-popover-container"
					linkAccessibility
					placement="left"
					tooltip="Help"
					#helpNavPopover="bs-popover"
					[isDisabled]="navbarOpen"
					[outsideClick]="true"
					[popover]="helpNav"
					(onHidden)="helpNavOpen = false"
					(onShown)="helpNavOpen = true"
				>
					<span class="fa-solid fa-fw fa-question-circle"></span>
					<span [hidden]="!navbarOpen">Help</span>
				</a>

				<ng-template #helpNav>
					<ul class="popover-menu" role="menu">
						<!-- Help -->
						<li>
							<a routerLink="/help" (click)="helpNavPopover.hide()"> Help Docs </a>
						</li>

						<!-- Feedback -->
						<li *isAuthenticated="true; and: showFeedbackOption">
							<a
								class="link"
								linkAccessibility
								(click)="showFeedbackModal(); helpNavPopover.hide()"
							>
								Give Feedback
							</a>
						</li>

						<!-- API Docs -->
						<li *ngIf="showApiDocsLink">
							<a [href]="apiDocsLink" target="_blank" (click)="helpNavPopover.hide()">
								API Docs
							</a>
						</li>

						<!-- About -->
						<li>
							<a routerLink="/about" (click)="helpNavPopover.hide()"> About </a>
						</li>
					</ul>
				</ng-template>
			</li>
		</ul>
	</div>

	<ul class="nav nav-collapse">
		<!-- Divider -->
		<li class="element element-divider element-divider-collapse"></li>

		<!-- Collapse/Expand -->
		<li class="element" linkAccessibility (click)="toggleNavbar()">
			<a container="body" placement="left" tooltip="Expand" [isDisabled]="navbarOpen">
				<span
					class="fa-solid fa-fw fa-angle-double-right"
					[class.fa-flip-horizontal]="navbarOpen"
				></span>
				<span [hidden]="!navbarOpen">Collapse</span>
			</a>
		</li>
	</ul>
</div>

<div class="navbar-content" [ngClass]="{ 'navbar-open': navbarOpen, 'navbar-close': !navbarOpen }">
	<ng-content></ng-content>
</div>
