<asy-modal
	title="Add Team Members"
	okText="Add Users"
	[disableOk]="submitting || addedMembers.length === 0"
	(cancel)="dialogRef.close()"
	(ok)="submit()"
>
	<h3>Add users</h3>
	<div class="form-group">
		<ng-select
			name="teamAdmin"
			appendTo="body"
			bindLabel="userModel.name"
			cdkFocusInitial
			placeholder="Search for user..."
			#selectDropdown
			[items]="(users$ | async) || []"
			[loading]="usersLoading"
			[typeahead]="usersInput$"
			(change)="typeaheadOnSelect($event, selectDropdown)"
		>
			<ng-template let-item="item" ng-label-tmp> </ng-template>
		</ng-select>
	</div>

	<ng-container *ngIf="addedMembers.length > 0">
		<h3 class="pt-2">Set user roles</h3>

		<table class="table table-condensed" aria-describedby="Set user roles">
			<thead>
				<tr>
					<th scope="col">Username</th>
					<th scope="col">Role</th>
					<th scope="col">&nbsp;</th>
				</tr>
			</thead>

			<tbody>
				<tr class="table-row" *ngFor="let invited of addedMembers; let i = index">
					<td class="text-nowrap">
						{{ invited.username }}
					</td>
					<td>
						<div class="dropdown dropdown-table-inline" container="body" dropdown>
							<span class="dropdown-toggle" dropdownToggle>
								<span class="mr-1">{{ invited.roleDisplay }}</span>
							</span>

							<ul class="dropdown-menu" role="menu" *dropdownMenu>
								<li
									[value]="role.role"
									*ngFor="let role of teamRoleOptions"
									(click)="updateRoleSelection(invited, role.role)"
								>
									<a class="dropdown-item">{{ role.label }}</a>
								</li>
							</ul>
						</div>
					</td>
					<td>
						<a
							class="btn-icon"
							container="body"
							placement="bottom"
							tooltip="Remove User"
							(click)="remove(i)"
						>
							<span class="fa-solid fa-lg fa-trash"></span>
						</a>
					</td>
				</tr>
			</tbody>
		</table>
	</ng-container>
</asy-modal>
